<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: STSPIN32G4 Driver Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Related components</a>  </div>
  <div class="headertitle"><div class="title">STSPIN32G4 Driver Library</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Related components</h2></td></tr>
<tr class="memitem:group__stspin32g4___basic"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stspin32g4___basic.html">Basic</a></td></tr>
<tr class="memdesc:group__stspin32g4___basic"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic function and definitions to work with STSPIN32G4. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__stspin32g4___i2c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stspin32g4___i2c.html">Driver Registers</a></td></tr>
<tr class="memdesc:group__stspin32g4___i2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function and definitions to directly access I2C registers of STSPIN32G4. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__stspin32g4___power_management"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stspin32g4___power_management.html">Power Management</a></td></tr>
<tr class="memdesc:group__stspin32g4___power_management"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function and definitions to manage regulators embedded in STSPIN32G4 and standby. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__stspin32g4___protections"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__stspin32g4___protections.html">Protections</a></td></tr>
<tr class="memdesc:group__stspin32g4___protections"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function and definitions to configure protection features of STSPIN32G4. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section attention"><dt>Attention</dt><dd></dd></dl>
<h2><center>&copy; Copyright (c) 2019 STMicroelectronics. All rights reserved.</center></h2>
<p >This software component is licensed by ST under Ultimate Liberty license SLA0044, the "License"; You may not use this file except in compliance with the License. You may obtain a copy of the License at: www.st.com/SLA0044</p>
<h2>Operation</h2>
<p >The STSPIN32G4 is a system in package integrating a triple high-performance STSPIN32G4f-bridge gate driver with a rich set of programmable features and one mixed signal STM32G431 microcontroller. This library provides functions to configure STSPIN32G4 gate driver but does not include functions to generate PWM signals for MOSFETs driving</p>
<dl class="section pre"><dt>Precondition</dt><dd>This library requires at least HAL drivers 1.3.0 or Low-layer (LL) drivers 1.5.0</dd></dl>
<p>The library should be included in an application as follows: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="stspin32g4_8h.html">stspin32g4.h</a>&gt;</span></div>
<div class="ttc" id="astspin32g4_8h_html"><div class="ttname"><a href="stspin32g4_8h.html">stspin32g4.h</a></div><div class="ttdoc">Interface of STSPIN32G4 driver library.</div></div>
</div><!-- fragment --><h3>Opening the driver</h3>
<div class="fragment"><div class="line"><a class="code hl_struct" href="struct_s_t_s_p_i_n32_g4___handle_type_def.html">STSPIN32G4_HandleTypeDef</a> hdlG4;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_enumeration" href="group__stspin32g4___power_management.html#ga60df0a1e61bbf69b1efdaf0158d6c256">STSPIN32G4_StatusTypeDef</a> res = <a class="code hl_function" href="group__stspin32g4___basic.html#ga5bf376fcddf6e8e725926d583239e95e">STSPIN32G4_init</a>(&amp;hdlG4);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(res != <a class="code hl_enumvalue" href="stspin32g4_8h.html#ga60df0a1e61bbf69b1efdaf0158d6c256a41469b422443f03202afb76c0c21c06b">STSPIN32G4_OK</a>)</div>
<div class="line">    <a class="code hl_function" href="group__stspin32g4___basic.html#ga1bdf8004ebf945e3f496624cc24a162e">STSPIN32G4_deInit</a>(&amp;hdlG4);</div>
<div class="ttc" id="agroup__stspin32g4___basic_html_ga1bdf8004ebf945e3f496624cc24a162e"><div class="ttname"><a href="group__stspin32g4___basic.html#ga1bdf8004ebf945e3f496624cc24a162e">STSPIN32G4_deInit</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_deInit(STSPIN32G4_HandleTypeDef *hdl)</div><div class="ttdoc">De-initialize the STSPIN32G4 driver.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:144</div></div>
<div class="ttc" id="agroup__stspin32g4___basic_html_ga5bf376fcddf6e8e725926d583239e95e"><div class="ttname"><a href="group__stspin32g4___basic.html#ga5bf376fcddf6e8e725926d583239e95e">STSPIN32G4_init</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_init(STSPIN32G4_HandleTypeDef *hdl)</div><div class="ttdoc">Initialize the STSPIN32G4 driver.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:74</div></div>
<div class="ttc" id="agroup__stspin32g4___power_management_html_ga60df0a1e61bbf69b1efdaf0158d6c256"><div class="ttname"><a href="group__stspin32g4___power_management.html#ga60df0a1e61bbf69b1efdaf0158d6c256">STSPIN32G4_StatusTypeDef</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef</div><div class="ttdoc">Possible results of library functions.</div><div class="ttdef"><b>Definition:</b> stspin32g4.h:206</div></div>
<div class="ttc" id="astruct_s_t_s_p_i_n32_g4___handle_type_def_html"><div class="ttname"><a href="struct_s_t_s_p_i_n32_g4___handle_type_def.html">STSPIN32G4_HandleTypeDef</a></div><div class="ttdoc">Handler of STSPIN32G4 driver to be used with all driver functions.</div><div class="ttdef"><b>Definition:</b> stspin32g4.h:303</div></div>
<div class="ttc" id="astspin32g4_8h_html_ga60df0a1e61bbf69b1efdaf0158d6c256a41469b422443f03202afb76c0c21c06b"><div class="ttname"><a href="stspin32g4_8h.html#ga60df0a1e61bbf69b1efdaf0158d6c256a41469b422443f03202afb76c0c21c06b">STSPIN32G4_OK</a></div><div class="ttdeci">@ STSPIN32G4_OK</div><div class="ttdef"><b>Definition:</b> stspin32g4.h:207</div></div>
</div><!-- fragment --><h3>Example</h3>
<p >The following code shows a minimal device configuration to operate the gate driver </p><div class="fragment"><div class="line"><span class="comment">// Purge registers to default values</span></div>
<div class="line"><a class="code hl_function" href="group__stspin32g4___basic.html#ga4d1271f6ae869f89e9a432db262be9d6">STSPIN32G4_reset</a>(&amp;hdlG4);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure the Buck regulator at 12V and map VCC UVLO on NFAULT pin</span></div>
<div class="line"><a class="code hl_struct" href="struct_s_t_s_p_i_n32_g4__conf_v_c_c.html">STSPIN32G4_confVCC</a> vcc = {.<a class="code hl_variable" href="struct_s_t_s_p_i_n32_g4__conf_v_c_c.html#ad8afb0beafadbf5523086a07395a1526">voltage</a> = _12V, .useNFAULT=<span class="keyword">true</span>, .useREADY=<span class="keyword">false</span>};</div>
<div class="line"><a class="code hl_function" href="group__stspin32g4___power_management.html#ga54b2de9fd2341c0193bcf437807d692f">STSPIN32G4_setVCC</a>(&amp;hdlG4, vcc);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure VDSP protection with 4us deglitch time and map triggering on NFAULT pin</span></div>
<div class="line"><a class="code hl_struct" href="struct_s_t_s_p_i_n32_g4__conf_v_d_s_p.html">STSPIN32G4_confVDSP</a> vdsp = {.<a class="code hl_variable" href="group__stspin32g4___protections.html#ga3386c1c11f04ded035d1806de7aee0ce">deglitchTime</a>=_4us, .useNFAULT=<span class="keyword">true</span>};</div>
<div class="line"><a class="code hl_function" href="group__stspin32g4___protections.html#ga459315a017567fa36edb0c96d84cac7e">STSPIN32G4_setVDSP</a>(&amp;hdlG4, vdsp);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// After reset a clearing of fault is needed to enable GHSx/GLSx outputs</span></div>
<div class="line"><a class="code hl_function" href="group__stspin32g4___basic.html#ga8c5228181b1732e33689cd9374510ffc">STSPIN32G4_clearFaults</a>(&amp;hdlG4);</div>
<div class="ttc" id="agroup__stspin32g4___basic_html_ga4d1271f6ae869f89e9a432db262be9d6"><div class="ttname"><a href="group__stspin32g4___basic.html#ga4d1271f6ae869f89e9a432db262be9d6">STSPIN32G4_reset</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_reset(STSPIN32G4_HandleTypeDef *hdl)</div><div class="ttdoc">Perform a reset. All registers will be set to their default values.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:1067</div></div>
<div class="ttc" id="agroup__stspin32g4___basic_html_ga8c5228181b1732e33689cd9374510ffc"><div class="ttname"><a href="group__stspin32g4___basic.html#ga8c5228181b1732e33689cd9374510ffc">STSPIN32G4_clearFaults</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_clearFaults(STSPIN32G4_HandleTypeDef *hdl)</div><div class="ttdoc">Clear a fault condition.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:1055</div></div>
<div class="ttc" id="agroup__stspin32g4___power_management_html_ga54b2de9fd2341c0193bcf437807d692f"><div class="ttname"><a href="group__stspin32g4___power_management.html#ga54b2de9fd2341c0193bcf437807d692f">STSPIN32G4_setVCC</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_setVCC(STSPIN32G4_HandleTypeDef *hdl, STSPIN32G4_confVCC vcc)</div><div class="ttdoc">Configures the Buck converter and VCC UVLO signaling.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:541</div></div>
<div class="ttc" id="agroup__stspin32g4___protections_html_ga3386c1c11f04ded035d1806de7aee0ce"><div class="ttname"><a href="group__stspin32g4___protections.html#ga3386c1c11f04ded035d1806de7aee0ce">STSPIN32G4_confVDSP::deglitchTime</a></div><div class="ttdeci">enum STSPIN32G4_confVDSP::degVDSP deglitchTime</div></div>
<div class="ttc" id="agroup__stspin32g4___protections_html_ga459315a017567fa36edb0c96d84cac7e"><div class="ttname"><a href="group__stspin32g4___protections.html#ga459315a017567fa36edb0c96d84cac7e">STSPIN32G4_setVDSP</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_setVDSP(STSPIN32G4_HandleTypeDef *hdl, STSPIN32G4_confVDSP vdsp)</div><div class="ttdoc">Configures the VDS monitoring protection.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:836</div></div>
<div class="ttc" id="astruct_s_t_s_p_i_n32_g4__conf_v_c_c_html"><div class="ttname"><a href="struct_s_t_s_p_i_n32_g4__conf_v_c_c.html">STSPIN32G4_confVCC</a></div><div class="ttdoc">Configuration for VCC voltage to be used with functions STSPIN32G4_setVCC() and STSPIN32G4_getVCC().</div><div class="ttdef"><b>Definition:</b> stspin32g4.h:221</div></div>
<div class="ttc" id="astruct_s_t_s_p_i_n32_g4__conf_v_c_c_html_ad8afb0beafadbf5523086a07395a1526"><div class="ttname"><a href="struct_s_t_s_p_i_n32_g4__conf_v_c_c.html#ad8afb0beafadbf5523086a07395a1526">STSPIN32G4_confVCC::voltage</a></div><div class="ttdeci">enum STSPIN32G4_confVCC::valVCC voltage</div></div>
<div class="ttc" id="astruct_s_t_s_p_i_n32_g4__conf_v_d_s_p_html"><div class="ttname"><a href="struct_s_t_s_p_i_n32_g4__conf_v_d_s_p.html">STSPIN32G4_confVDSP</a></div><div class="ttdoc">Configuration for VDS monitoring protection to be used with functions STSPIN32G4_setVDSP() and STSPIN...</div><div class="ttdef"><b>Definition:</b> stspin32g4.h:253</div></div>
</div><!-- fragment --> <h3>Closing the driver</h3>
<div class="fragment"><div class="line"><span class="comment">// Reset the device to put GHSx/GLSx outputs in safe state</span></div>
<div class="line"><a class="code hl_function" href="group__stspin32g4___basic.html#ga4d1271f6ae869f89e9a432db262be9d6">STSPIN32G4_reset</a>(&amp;hdlG4);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Close the driver</span></div>
<div class="line"><a class="code hl_function" href="group__stspin32g4___basic.html#ga1bdf8004ebf945e3f496624cc24a162e">STSPIN32G4_deInit</a>(&amp;hdlG4);</div>
</div><!-- fragment --><h3>Standby</h3>
<div class="fragment"><div class="line"><span class="comment">// Enter Standby enabling low quiescent regulator</span></div>
<div class="line"><span class="keywordflow">if</span>(<a class="code hl_enumvalue" href="stspin32g4_8h.html#ga60df0a1e61bbf69b1efdaf0158d6c256a41469b422443f03202afb76c0c21c06b">STSPIN32G4_OK</a> == <a class="code hl_function" href="group__stspin32g4___power_management.html#ga63f776b1baec33e5151450a425a09518">STSPIN32G4_standby</a>(&amp;hdlG4, <span class="keyword">true</span>))</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Stay 1s in standby</span></div>
<div class="line">  HAL_Delay(1000);  <span class="comment">// or LL_mDelay(1000);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wakeup the driver waiting 4ms for completion of VCC soft-start</span></div>
<div class="line">  <a class="code hl_function" href="group__stspin32g4___power_management.html#ga3046e12e228e252476ddc5414c3b8967">STSPIN32G4_wakeup</a>(&amp;hdlG4, 4);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Consumption from 3.3V supply is likely too high</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__stspin32g4___power_management_html_ga3046e12e228e252476ddc5414c3b8967"><div class="ttname"><a href="group__stspin32g4___power_management.html#ga3046e12e228e252476ddc5414c3b8967">STSPIN32G4_wakeup</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_wakeup(STSPIN32G4_HandleTypeDef *hdl, uint8_t timeout_ms)</div><div class="ttdoc">Wake up from standby.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:1275</div></div>
<div class="ttc" id="agroup__stspin32g4___power_management_html_ga63f776b1baec33e5151450a425a09518"><div class="ttname"><a href="group__stspin32g4___power_management.html#ga63f776b1baec33e5151450a425a09518">STSPIN32G4_standby</a></div><div class="ttdeci">STSPIN32G4_StatusTypeDef STSPIN32G4_standby(STSPIN32G4_HandleTypeDef *hdl, bool enableStbyReg)</div><div class="ttdoc">Requests the device to enter standby mode.</div><div class="ttdef"><b>Definition:</b> stspin32g4.c:1087</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
