<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: Six-Step, F0xx Sensorless with ADC Position Feedback</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Six-Step, F0xx Sensorless with ADC Position Feedback<div class="ingroups"><a class="el" href="group___m_c_s_d_k.html">MCSDK</a> &raquo; <a class="el" href="group___speedn_pos_fdbk.html">Speed &amp; Position Feedback</a> &raquo; <a class="el" href="group___speedn_pos_fdbk___bemf.html">Six-Step Back-EMF sensing</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>STM32F0, Sensorless Bemf acquisition with ADC implementation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_bemf___a_d_c__values__t.html">Bemf_ADC_values_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used to handle the data of an instance of the Bemf component.  <a href="struct_bemf___a_d_c__values__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_bemf___a_d_c___params__t.html">Bemf_ADC_Params_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bemf_ADC parameters definition.  <a href="struct_bemf___a_d_c___params__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_bemf___sensing___params.html">Bemf_Sensing_Params</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used to handle the thresholds for bemf zero crossing detection.  <a href="struct_bemf___sensing___params.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_bemf___demag___params.html">Bemf_Demag_Params</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used to handle the demagnetization time before starting bemf acquisition.  <a href="struct_bemf___demag___params.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used to handle the data of an instance of the B-emf Feedback component.  <a href="struct_bemf___a_d_c___handle__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaff1e5c7069a952be7457245ba5afea88"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaff1e5c7069a952be7457245ba5afea88">BEMF_BUFFER_LENGTH</a>&#160;&#160;&#160;((uint8_t) 128)</td></tr>
<tr class="separator:gaff1e5c7069a952be7457245ba5afea88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83c6ac1d98de484dbef3f704826318f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga83c6ac1d98de484dbef3f704826318f2">SPEED_BUFFER_LENGTH</a>&#160;&#160;&#160;((uint8_t) 18)</td></tr>
<tr class="separator:ga83c6ac1d98de484dbef3f704826318f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7dcf7c6ecb1a2dfe1bb43211dde0e80f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga7dcf7c6ecb1a2dfe1bb43211dde0e80f">BADC_Init</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga7dcf7c6ecb1a2dfe1bb43211dde0e80f"><td class="mdescLeft">&#160;</td><td class="mdescRight">It initializes ADC1, DMA and NVIC for three bemf voltages reading.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga7dcf7c6ecb1a2dfe1bb43211dde0e80f">More...</a><br /></td></tr>
<tr class="separator:ga7dcf7c6ecb1a2dfe1bb43211dde0e80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16d1fe93592a6d68c449ed08dc4c9ca7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga16d1fe93592a6d68c449ed08dc4c9ca7">BADC_Clear</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga16d1fe93592a6d68c449ed08dc4c9ca7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the ADC status.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga16d1fe93592a6d68c449ed08dc4c9ca7">More...</a><br /></td></tr>
<tr class="separator:ga16d1fe93592a6d68c449ed08dc4c9ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf39116c882a7fed0b0ba4ad5f8c9d60"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gadf39116c882a7fed0b0ba4ad5f8c9d60">BADC_IsZcDetected</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, <a class="el" href="group__pwm__curr__fdbk.html#ga5febe836591f0388113c624ad3e1a16a">PWMC_Handle_t</a> *pHandlePWMC)</td></tr>
<tr class="memdesc:gadf39116c882a7fed0b0ba4ad5f8c9d60"><td class="mdescLeft">&#160;</td><td class="mdescRight">It gets last bemf value and checks for zero crossing detection. It updates speed loop timer and electrical angle accordingly.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gadf39116c882a7fed0b0ba4ad5f8c9d60">More...</a><br /></td></tr>
<tr class="separator:gadf39116c882a7fed0b0ba4ad5f8c9d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7eeb20561b4ffcf93fc46c8cf05e23f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaf7eeb20561b4ffcf93fc46c8cf05e23f">BADC_SpeedMeasureOn</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gaf7eeb20561b4ffcf93fc46c8cf05e23f"><td class="mdescLeft">&#160;</td><td class="mdescRight">It enables the speed loop (low frequency) timer.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaf7eeb20561b4ffcf93fc46c8cf05e23f">More...</a><br /></td></tr>
<tr class="separator:gaf7eeb20561b4ffcf93fc46c8cf05e23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga70009f6fc85c0dc8783079e99a19dba7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga70009f6fc85c0dc8783079e99a19dba7">BADC_SpeedMeasureOff</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga70009f6fc85c0dc8783079e99a19dba7"><td class="mdescLeft">&#160;</td><td class="mdescRight">It disables the speed loop (low frequency) timer.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga70009f6fc85c0dc8783079e99a19dba7">More...</a><br /></td></tr>
<tr class="separator:ga70009f6fc85c0dc8783079e99a19dba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4aef0f7a6b6cc028f885120cb26b1544"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga4aef0f7a6b6cc028f885120cb26b1544">BADC_SetSamplingPoint</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, <a class="el" href="group__pwm__curr__fdbk.html#ga5febe836591f0388113c624ad3e1a16a">PWMC_Handle_t</a> *pHandlePWMC, <a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *pHandleSTC)</td></tr>
<tr class="memdesc:ga4aef0f7a6b6cc028f885120cb26b1544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the ADC for the current sampling. It means set the sampling point via TIM1_Ch4 value, the ADC sequence and channels.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga4aef0f7a6b6cc028f885120cb26b1544">More...</a><br /></td></tr>
<tr class="separator:ga4aef0f7a6b6cc028f885120cb26b1544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f817a0419f9923fb8f982ed0e6ad6cc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga5f817a0419f9923fb8f982ed0e6ad6cc">BADC_CalcAvrgMecSpeedUnit</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, int16_t *pMecSpeedUnit)</td></tr>
<tr class="memdesc:ga5f817a0419f9923fb8f982ed0e6ad6cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method must be called - at least - with the same periodicity on which speed control is executed. It computes and returns - through parameter hMecSpeedUnit - the rotor average mechanical speed, expressed in Unit. Average is computed considering a FIFO depth equal to SpeedBufferSizeUnit. Moreover it also computes and returns the reliability state of the sensor.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga5f817a0419f9923fb8f982ed0e6ad6cc">More...</a><br /></td></tr>
<tr class="separator:ga5f817a0419f9923fb8f982ed0e6ad6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabac55d6c195cda27c7139d8066ae146f"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gabac55d6c195cda27c7139d8066ae146f">BADC_LfTim_UP_IRQHandler</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gabac55d6c195cda27c7139d8066ae146f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method of the class to be called when speed loop timer update event occurs It updates the electrical angle accumulator and resets zero crossing detection flag.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gabac55d6c195cda27c7139d8066ae146f">More...</a><br /></td></tr>
<tr class="separator:gabac55d6c195cda27c7139d8066ae146f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed73244222e539044a088e1335ae1f1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaed73244222e539044a088e1335ae1f1b">BADC_SetDirection</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, uint8_t direction)</td></tr>
<tr class="memdesc:gaed73244222e539044a088e1335ae1f1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">forces the rotation direction  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaed73244222e539044a088e1335ae1f1b">More...</a><br /></td></tr>
<tr class="separator:gaed73244222e539044a088e1335ae1f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga43286f6fd372798e5e050ab064a054ae"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga43286f6fd372798e5e050ab064a054ae">BADC_IsObserverConverged</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga43286f6fd372798e5e050ab064a054ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">It internally performs a checks necessary to state whether the bemf algorithm converged. To be periodically called during motor open-loop ramp-up (e.g. at the same frequency of SPD_CalcElAngle), it returns true if the estimated angle and speed can be considered reliable, false otherwise.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga43286f6fd372798e5e050ab064a054ae">More...</a><br /></td></tr>
<tr class="separator:ga43286f6fd372798e5e050ab064a054ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5deba27b8f6543cd76150b9973a0960"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gad5deba27b8f6543cd76150b9973a0960">BADC_Start</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, uint8_t step)</td></tr>
<tr class="memdesc:gad5deba27b8f6543cd76150b9973a0960"><td class="mdescLeft">&#160;</td><td class="mdescRight">It starts bemf ADC conversion of the phase depending on current step.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gad5deba27b8f6543cd76150b9973a0960">More...</a><br /></td></tr>
<tr class="separator:gad5deba27b8f6543cd76150b9973a0960"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78af1ff04f60c19f4b13170932f61c4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga78af1ff04f60c19f4b13170932f61c4b">BADC_Stop</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga78af1ff04f60c19f4b13170932f61c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It stops bemf ADC conversion.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga78af1ff04f60c19f4b13170932f61c4b">More...</a><br /></td></tr>
<tr class="separator:ga78af1ff04f60c19f4b13170932f61c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca2120645a9ca3cb3e76cadbee51b5f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaca2120645a9ca3cb3e76cadbee51b5f4">BADC_SelectAdcChannel</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, uint8_t Phase)</td></tr>
<tr class="memdesc:gaca2120645a9ca3cb3e76cadbee51b5f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">It configures the proper ADC channel according to the current step corresponding to the floating phase. To be periodically called at least at every step change.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaca2120645a9ca3cb3e76cadbee51b5f4">More...</a><br /></td></tr>
<tr class="separator:gaca2120645a9ca3cb3e76cadbee51b5f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1fb54960f0213447cd113c9316c44861"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga1fb54960f0213447cd113c9316c44861">BADC_CalcElAngle</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga1fb54960f0213447cd113c9316c44861"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method updates the estimated electrical angle.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga1fb54960f0213447cd113c9316c44861">More...</a><br /></td></tr>
<tr class="separator:ga1fb54960f0213447cd113c9316c44861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae58819153d205b05c8679bcffb65269b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gae58819153d205b05c8679bcffb65269b">BADC_CalcAvrgElSpeedDpp</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gae58819153d205b05c8679bcffb65269b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method must be called - at least - with the same periodicity on which speed control is executed. It computes and update component variable hElSpeedDpp that is estimated average electrical speed expressed in dpp used for instance in observer equations. Average is computed considering a FIFO depth equal to bSpeedBufferSizedpp.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gae58819153d205b05c8679bcffb65269b">More...</a><br /></td></tr>
<tr class="separator:gae58819153d205b05c8679bcffb65269b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf6e4cf18941ebc1e4e71782beedcd98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaaf6e4cf18941ebc1e4e71782beedcd98">BADC_SetLfTimerRevUp</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, int16_t hAvrMecSpeedUnit)</td></tr>
<tr class="memdesc:gaaf6e4cf18941ebc1e4e71782beedcd98"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is used during revup phase to synchronize estimated rotor position from Bemf acquisition with imposed virtual speed <br  />
  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaaf6e4cf18941ebc1e4e71782beedcd98">More...</a><br /></td></tr>
<tr class="separator:gaaf6e4cf18941ebc1e4e71782beedcd98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61edeb0c711128d31ade66aac22875a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga61edeb0c711128d31ade66aac22875a2">BADC_CalcRevUpDemagTime</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, <a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *pHandleSTC)</td></tr>
<tr class="memdesc:ga61edeb0c711128d31ade66aac22875a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">It calculates and stores in the corresponding variable the demagnetization time in open loop operation <br  />
  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga61edeb0c711128d31ade66aac22875a2">More...</a><br /></td></tr>
<tr class="separator:ga61edeb0c711128d31ade66aac22875a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4861019a35d7669b912b60b733a1a77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaa4861019a35d7669b912b60b733a1a77">BADC_CalcRunDemagTime</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, <a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *pHandleSTC)</td></tr>
<tr class="memdesc:gaa4861019a35d7669b912b60b733a1a77"><td class="mdescLeft">&#160;</td><td class="mdescRight">It calculates and stores in the corresponding variable the demagnetization time in closed loop operation <br  />
  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaa4861019a35d7669b912b60b733a1a77">More...</a><br /></td></tr>
<tr class="separator:gaa4861019a35d7669b912b60b733a1a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6a7039ad7ea60ee3aa867120b3ffeb85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga6a7039ad7ea60ee3aa867120b3ffeb85">BADC_SetLoopClosed</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga6a7039ad7ea60ee3aa867120b3ffeb85"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method must be called after switch-over procedure when virtual speed sensor transition is ended. <br  />
  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga6a7039ad7ea60ee3aa867120b3ffeb85">More...</a><br /></td></tr>
<tr class="separator:ga6a7039ad7ea60ee3aa867120b3ffeb85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa90246d9427c9e3c62b63aba52fc2e26"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaa90246d9427c9e3c62b63aba52fc2e26">BADC_GetLastBemfValue</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle, uint8_t phase)</td></tr>
<tr class="memdesc:gaa90246d9427c9e3c62b63aba52fc2e26"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the last acquired bemf value.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gaa90246d9427c9e3c62b63aba52fc2e26">More...</a><br /></td></tr>
<tr class="separator:gaa90246d9427c9e3c62b63aba52fc2e26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad758297237033e039cc295959701dbb0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gad758297237033e039cc295959701dbb0">BADC_GetBemfZcrFlag</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gad758297237033e039cc295959701dbb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the zero crossing detection flag.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#gad758297237033e039cc295959701dbb0">More...</a><br /></td></tr>
<tr class="separator:gad758297237033e039cc295959701dbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c2b1080dcf2fc45133af906a268476b"><td class="memItemLeft" align="right" valign="top">__weak bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga0c2b1080dcf2fc45133af906a268476b">BADC_IsSpeedReliable</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga0c2b1080dcf2fc45133af906a268476b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns false if calculated speed is out of reliability ranges.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga0c2b1080dcf2fc45133af906a268476b">More...</a><br /></td></tr>
<tr class="separator:ga0c2b1080dcf2fc45133af906a268476b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e4dd0497e2aec30ff61901de7924fc0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga9e4dd0497e2aec30ff61901de7924fc0">BADC_IsPeriodReliable</a> (<a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga9e4dd0497e2aec30ff61901de7924fc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns false if calculated speed loop timer is out of reliability ranges.  <a href="group___f0_x_x___bemf___a_d_c___speedn_pos_fdbk.html#ga9e4dd0497e2aec30ff61901de7924fc0">More...</a><br /></td></tr>
<tr class="separator:ga9e4dd0497e2aec30ff61901de7924fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >STM32F0, Sensorless Bemf acquisition with ADC implementation. </p>
<p >This component is used in applications based on an STM32F0 MCU and using a sensorless position feedback. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaff1e5c7069a952be7457245ba5afea88" name="gaff1e5c7069a952be7457245ba5afea88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaff1e5c7069a952be7457245ba5afea88">&#9670;&#160;</a></span>BEMF_BUFFER_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BEMF_BUFFER_LENGTH&#160;&#160;&#160;((uint8_t) 128)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Length of buffer used to store the bemf measurements </p>

</div>
</div>
<a id="ga83c6ac1d98de484dbef3f704826318f2" name="ga83c6ac1d98de484dbef3f704826318f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83c6ac1d98de484dbef3f704826318f2">&#9670;&#160;</a></span>SPEED_BUFFER_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPEED_BUFFER_LENGTH&#160;&#160;&#160;((uint8_t) 18)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Length of buffer used to store the timer period measurements </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gae58819153d205b05c8679bcffb65269b" name="gae58819153d205b05c8679bcffb65269b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae58819153d205b05c8679bcffb65269b">&#9670;&#160;</a></span>BADC_CalcAvrgElSpeedDpp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_CalcAvrgElSpeedDpp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method must be called - at least - with the same periodicity on which speed control is executed. It computes and update component variable hElSpeedDpp that is estimated average electrical speed expressed in dpp used for instance in observer equations. Average is computed considering a FIFO depth equal to bSpeedBufferSizedpp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5f817a0419f9923fb8f982ed0e6ad6cc" name="ga5f817a0419f9923fb8f982ed0e6ad6cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f817a0419f9923fb8f982ed0e6ad6cc">&#9670;&#160;</a></span>BADC_CalcAvrgMecSpeedUnit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BADC_CalcAvrgMecSpeedUnit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>pMecSpeedUnit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method must be called - at least - with the same periodicity on which speed control is executed. It computes and returns - through parameter hMecSpeedUnit - the rotor average mechanical speed, expressed in Unit. Average is computed considering a FIFO depth equal to SpeedBufferSizeUnit. Moreover it also computes and returns the reliability state of the sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">pMecSpeedUnit</td><td>pointer to int16_t, used to return the rotor average mechanical speed (expressed in the unit defined by <a class="el" href="mc__stm__types_8h.html#a068140274b96a55eabb3ed3261c30d75" title="Rotation speed unit used at the interface with the application.">SPEED_UNIT</a>) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>speed sensor reliability, measured with reference to parameters Reliability_hysteresys, VariancePercentage and SpeedBufferSize true = sensor information is reliable false = sensor information is not reliable </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1fb54960f0213447cd113c9316c44861" name="ga1fb54960f0213447cd113c9316c44861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1fb54960f0213447cd113c9316c44861">&#9670;&#160;</a></span>BADC_CalcElAngle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t BADC_CalcElAngle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method updates the estimated electrical angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int16_t</td><td>rotor electrical angle (s16Degrees) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga61edeb0c711128d31ade66aac22875a2" name="ga61edeb0c711128d31ade66aac22875a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61edeb0c711128d31ade66aac22875a2">&#9670;&#160;</a></span>BADC_CalcRevUpDemagTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_CalcRevUpDemagTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandleSTC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It calculates and stores in the corresponding variable the demagnetization time in open loop operation <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">pHandleSTC</td><td>handler of the current instance of the Speed Control component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa4861019a35d7669b912b60b733a1a77" name="gaa4861019a35d7669b912b60b733a1a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa4861019a35d7669b912b60b733a1a77">&#9670;&#160;</a></span>BADC_CalcRunDemagTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_CalcRunDemagTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandleSTC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It calculates and stores in the corresponding variable the demagnetization time in closed loop operation <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">pHandleSTC</td><td>handler of the current instance of the Speed Control component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga16d1fe93592a6d68c449ed08dc4c9ca7" name="ga16d1fe93592a6d68c449ed08dc4c9ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga16d1fe93592a6d68c449ed08dc4c9ca7">&#9670;&#160;</a></span>BADC_Clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_Clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the ADC status. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad758297237033e039cc295959701dbb0" name="gad758297237033e039cc295959701dbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad758297237033e039cc295959701dbb0">&#9670;&#160;</a></span>BADC_GetBemfZcrFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BADC_GetBemfZcrFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the zero crossing detection flag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>zero crossing detection flag </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa90246d9427c9e3c62b63aba52fc2e26" name="gaa90246d9427c9e3c62b63aba52fc2e26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa90246d9427c9e3c62b63aba52fc2e26">&#9670;&#160;</a></span>BADC_GetLastBemfValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t BADC_GetLastBemfValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the last acquired bemf value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">phase</td><td>motor phase under investigation </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">uint16_t</td><td>Bemf value </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga7dcf7c6ecb1a2dfe1bb43211dde0e80f" name="ga7dcf7c6ecb1a2dfe1bb43211dde0e80f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7dcf7c6ecb1a2dfe1bb43211dde0e80f">&#9670;&#160;</a></span>BADC_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It initializes ADC1, DMA and NVIC for three bemf voltages reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga43286f6fd372798e5e050ab064a054ae" name="ga43286f6fd372798e5e050ab064a054ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga43286f6fd372798e5e050ab064a054ae">&#9670;&#160;</a></span>BADC_IsObserverConverged()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BADC_IsObserverConverged </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It internally performs a checks necessary to state whether the bemf algorithm converged. To be periodically called during motor open-loop ramp-up (e.g. at the same frequency of SPD_CalcElAngle), it returns true if the estimated angle and speed can be considered reliable, false otherwise. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">hForcedMecSpeedUnit</td><td>Mechanical speed in 0.1Hz unit as forced by VSS </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>sensor reliability state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9e4dd0497e2aec30ff61901de7924fc0" name="ga9e4dd0497e2aec30ff61901de7924fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e4dd0497e2aec30ff61901de7924fc0">&#9670;&#160;</a></span>BADC_IsPeriodReliable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BADC_IsPeriodReliable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns false if calculated speed loop timer is out of reliability ranges. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>reliability flag </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0c2b1080dcf2fc45133af906a268476b" name="ga0c2b1080dcf2fc45133af906a268476b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c2b1080dcf2fc45133af906a268476b">&#9670;&#160;</a></span>BADC_IsSpeedReliable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool BADC_IsSpeedReliable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns false if calculated speed is out of reliability ranges. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>reliability flag </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gadf39116c882a7fed0b0ba4ad5f8c9d60" name="gadf39116c882a7fed0b0ba4ad5f8c9d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf39116c882a7fed0b0ba4ad5f8c9d60">&#9670;&#160;</a></span>BADC_IsZcDetected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BADC_IsZcDetected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwm__curr__fdbk.html#ga5febe836591f0388113c624ad3e1a16a">PWMC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandlePWMC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It gets last bemf value and checks for zero crossing detection. It updates speed loop timer and electrical angle accordingly. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">pHandlePWMC</td><td>handler of the current instance of the PWMC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabac55d6c195cda27c7139d8066ae146f" name="gabac55d6c195cda27c7139d8066ae146f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabac55d6c195cda27c7139d8066ae146f">&#9670;&#160;</a></span>BADC_LfTim_UP_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * BADC_LfTim_UP_IRQHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method of the class to be called when speed loop timer update event occurs It updates the electrical angle accumulator and resets zero crossing detection flag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaca2120645a9ca3cb3e76cadbee51b5f4" name="gaca2120645a9ca3cb3e76cadbee51b5f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaca2120645a9ca3cb3e76cadbee51b5f4">&#9670;&#160;</a></span>BADC_SelectAdcChannel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_SelectAdcChannel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>Phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It configures the proper ADC channel according to the current step corresponding to the floating phase. To be periodically called at least at every step change. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">Phase</td><td>Floaing phase for bemf acquisition </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaed73244222e539044a088e1335ae1f1b" name="gaed73244222e539044a088e1335ae1f1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed73244222e539044a088e1335ae1f1b">&#9670;&#160;</a></span>BADC_SetDirection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_SetDirection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>forces the rotation direction </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">direction</td><td>imposed direction </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaaf6e4cf18941ebc1e4e71782beedcd98" name="gaaf6e4cf18941ebc1e4e71782beedcd98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf6e4cf18941ebc1e4e71782beedcd98">&#9670;&#160;</a></span>BADC_SetLfTimerRevUp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_SetLfTimerRevUp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>hAvrMecSpeedUnit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method is used during revup phase to synchronize estimated rotor position from Bemf acquisition with imposed virtual speed <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">hAvrMecSpeedUnit</td><td>Mechanical speed imposed by virtual speed component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga6a7039ad7ea60ee3aa867120b3ffeb85" name="ga6a7039ad7ea60ee3aa867120b3ffeb85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6a7039ad7ea60ee3aa867120b3ffeb85">&#9670;&#160;</a></span>BADC_SetLoopClosed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_SetLoopClosed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method must be called after switch-over procedure when virtual speed sensor transition is ended. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4aef0f7a6b6cc028f885120cb26b1544" name="ga4aef0f7a6b6cc028f885120cb26b1544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4aef0f7a6b6cc028f885120cb26b1544">&#9670;&#160;</a></span>BADC_SetSamplingPoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_SetSamplingPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwm__curr__fdbk.html#ga5febe836591f0388113c624ad3e1a16a">PWMC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandlePWMC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandleSTC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the ADC for the current sampling. It means set the sampling point via TIM1_Ch4 value, the ADC sequence and channels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">pHandlePWMC</td><td>handler of the current instance of the PWMC component </td></tr>
    <tr><td class="paramname">pHandleSTC</td><td>handler of the current instance of the Speed Control component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga70009f6fc85c0dc8783079e99a19dba7" name="ga70009f6fc85c0dc8783079e99a19dba7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga70009f6fc85c0dc8783079e99a19dba7">&#9670;&#160;</a></span>BADC_SpeedMeasureOff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_SpeedMeasureOff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It disables the speed loop (low frequency) timer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf7eeb20561b4ffcf93fc46c8cf05e23f" name="gaf7eeb20561b4ffcf93fc46c8cf05e23f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf7eeb20561b4ffcf93fc46c8cf05e23f">&#9670;&#160;</a></span>BADC_SpeedMeasureOn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_SpeedMeasureOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It enables the speed loop (low frequency) timer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad5deba27b8f6543cd76150b9973a0960" name="gad5deba27b8f6543cd76150b9973a0960"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad5deba27b8f6543cd76150b9973a0960">&#9670;&#160;</a></span>BADC_Start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_Start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It starts bemf ADC conversion of the phase depending on current step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
    <tr><td class="paramname">step</td><td>current step of the six-step sequence </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga78af1ff04f60c19f4b13170932f61c4b" name="ga78af1ff04f60c19f4b13170932f61c4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga78af1ff04f60c19f4b13170932f61c4b">&#9670;&#160;</a></span>BADC_Stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BADC_Stop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bemf___a_d_c___handle__t.html">Bemf_ADC_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It stops bemf ADC conversion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the Bemf_ADC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
