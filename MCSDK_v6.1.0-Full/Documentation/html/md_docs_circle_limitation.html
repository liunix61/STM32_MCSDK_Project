<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: Circle limitation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Circle limitation </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >As discussed in the <a class="el" href="md_docs_reference_frame_transformations.html">Reference frame transformation</a> section, FOC allows to separately control the torque and the flux of a 3-phase permanent magnet motor. After the two new values( \(v_d^*\) and \(v_q^*\)) of the stator voltage producing flux and torque components of the stator current have been independently computed by flux and torque PIDs, it is necessary to saturate the magnitude of the resulting vector ( \(\left|\vec{v}^*\right|\)) before passing them to the Reverse Park transformation and, finally, to the SVPWM block.</p>
<p >The saturation boundary is normally given by the value (<code>S16_MAX=32767</code>) which produces the maximum output voltage magnitude (corresponding to a duty cycle going from 0% to 100%).</p>
<p >Nevertheless, when using a single-shunt or three-shunt resistor configuration and depending on PWM frequency, it might be necessary to limit the maximum PWM duty cycle to guarantee the proper functioning of the stator currents reading block.</p>
<p >For this reason, the saturation boundary could be a value slightly lower than <code>S16_MAX</code> depending on PWM switching frequency when using a single-shunt or three-shunt resistor configuration.</p>
<p >The algorithm policy is to keep \(v_d\) as it has been computed by \(v_d^*\) with a maximum value equal to 95% of MMI S16_MAX. \(v_q\) is then computed in order to match the MMI S16_MAX limitation.</p>
<p >The circle limitation function performs the discussed stator voltage components saturation, as illustrated below:</p>
<div class="image">
<object type="image/svg+xml" data="circle_limiation_principle.svg" style="pointer-events: none;"></object>
<div class="caption">
Circle limitation working principle</div></div>
    <p >\(v_d\) and \(v_q\) represent the saturated stator voltage components to be passed to the Reverse Park transformation function, while \(v_d^*\) and \(v_q^*\) are the outputs of the PID current controllers. From geometrical considerations, it is possible to draw the following relationship:</p>
<p >$$ v_d = MIN(v_d^*, v_d MAX) $$ $$ v_q = \sqrt(r_2^2-v_d^2\ ) $$</p>
<p ><a class="el" href="md_docs_current_sampling_intro.html">Next: Current Sampling</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
