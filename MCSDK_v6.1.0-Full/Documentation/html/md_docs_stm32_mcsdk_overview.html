<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: STM32 motor control SDK overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">STM32 motor control SDK overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Package content and installation</h1>
<p >The STM32 MC SDK contains the following items:</p>
<ul>
<li>STM32 MC firmware</li>
<li>STM32 MC Workbench</li>
<li>STM32 MC Board Manager</li>
<li>STM32 Motor Pilot</li>
<li>The documentation of the STM32 MC SDK</li>
</ul>
<p >This package is provided as an executable that installs all the items mentioned above on the user’s computer.</p>
<p >The STM32 MC SDK depends on STM32Cube and STM32CubeMx. Hence, STM32CubeMx version 4.24.0 or later must be installed before the SDK.</p>
<p >More information about STM32CubeMx is available at <a href="http://www.st.com/">www.st.com.</a></p>
<p ><b>Note:</b> <em>STM32CubeMx must be run at least once before the MC SDK can be installed.</em></p>
<h1>Motor control application workflow</h1>
<p >The design of a MC software application that uses the STM32 MC SDK typically starts with the MC WB. With this tool, users configure the MC SDK according to the characteristics of their motor, their power stage, their control stage and the chosen STM32 MCU.</p>
<div class="image">
<object type="image/svg+xml" data="mc_firmware_environment.svg" style="pointer-events: none;"></object>
<div class="caption">
Motor control firmware in its environment</div></div>
    <p >Based on these characteristics, MC WB chooses the appropriate firmware components from the PMSM FOC library, computes their configuration parameters, produces a STM32CubeMx project file (referred to as the IOC file from now on, due to its name terminated by the .ioc extension.) and executes STM32CubeMx with this project.</p>
<p >The result of this execution is the generation of a complete software project that contains the source code and libraries needed to spin the motors of the application. This software project can be directly opened in the IDE chosen in the workbench.</p>
<p >The code generated by STM32CubeMx configures all the peripherals required to control the application’s motors, with the parameters provided by the MC WB. This code also initializes the MC firmware subsystem, sets the STM32 clocks and interrupts handlers so that the motor(s) can be controlled properly.</p>
<p >This software project can then be modified by users to add their own code. Refer to application note for detailed information on that subject.</p>
<p >With this workflow, the only tool that is visible to users is the STM32 MC WB. This is sufficient for many applications. If the users need to tune other aspects of their system that impacts the configuration of the STM32 MCU, they can use STM32CubeMx directly: they need to load the project generated by MC WB in CubeMx and then they can modify what they need and finally generate the project again..</p>
<p >Refer to STM32 MC Workbench section of AN5166 for more details on the interactions between STM32CubeMx and STM32 motor control workbench.</p>
<p >The figure below shows the MC software application design workflow.</p>
<div class="image">
<object type="image/svg+xml" data="mcsdk_workflow.svg" style="pointer-events: none;"></object>
<div class="caption">
STM32 motor control SDK workflow</div></div>
    <p >In this workflow, STM32 motor control workbench is responsible for computing motor control parameters and instructing STM32 CubeMx on how to configure the hardware IPs needed for it while STM32 CubeMx is used to generate the project and the hardware IPs initialization code. In addition, STM32 CubeMx can be used to configure hardware IPs that are not used for motor control.</p>
<p >The Control stage is at the limit between the both. It is selected and partially configured in the STM32 MC WB STM32CubeMx manages the rest of the configuration.</p>
<h1>STM32Cube firmware</h1>
<p >STM32 MC firmware uses the low layer drivers (LL) of the Cube firmware for interfacing with the peripherals it needs to access. These LL drivers are built on the standard CMSIS library.</p>
<p >Using LL offers a good compromise between performances and interface stability in time.</p>
<p >In some places of the code of the PMSM FOC library, direct accesses to hardware registers have been used, for performance reasons.</p>
<h1>STM32 MC firmware</h1>
<p >The STM32 MC firmware is the heart of the SDK. It provides all the software components needed to control PMSM using the FOC strategy, and integrates these components into a MC subsystem. It offers a versatile set of interfaces that custom applications can use to actually drive motors according to their needs.</p>
<p >The figure below shows the architecture of the STM32 an MC firmware.</p>
<p >The firmware consists of the three following functional sets:</p>
<ul>
<li>The <b>PMSM FOC Library</b> contains software components that implement the motor control features;</li>
<li>The <b>UI Library</b> contains software components that deal with the communication between the motor control firmware subsystem and either the user or an offloaded application;</li>
<li>The <b>motor control cockpit</b> integrates all these software components into a motor control firmware subsystem and implements the regulation loops.</li>
</ul>
<div class="image">
<object type="image/svg+xml" data="mcfw_architecture.svg" style="pointer-events: none;"></object>
<div class="caption">
STM32 motor control firmware architecture</div></div>
    <h2>PMSM FOC Library</h2>
<p >The <b>PMSM FOC Library</b> is a collection of software components. Each component implements a feature involved in MC such as, for instance, the speed and position sensing, the current sensing, or motor control algorithms.</p>
<p >For some features, the library provides several components, each containing a different implementation. This allows for supporting various hardware configurations in an efficient way. The components to use are then chosen depending on the characteristics of the user’s application, and are integrated into a motor control firmware subsystem.</p>
<p ><b>Note</b>: For dual motor applications, each motor may use different components for a given feature.</p>
<p >The next figure summarizes the features provided by the PMSM FOC library as components. The list of most of the components in the PMSM FOC library and their specificities is described in Section 3.3 Motor control firmware components.</p>
<div class="image">
<object type="image/svg+xml" data="foc_lib_features.svg" style="pointer-events: none;"></object>
<div class="caption">
PMSM FOC Library features delivered as components</div></div>
    <h2>User Interface Library</h2>
<p >The <b>User Interface Library</b> or <b>UI Library</b> contains software components that deal with the communication between the motor control firmware subsystem and the outside world using a serial port or a DAC. This library is used to allow the STM32 Motor Control Workbench to connect to the Application and control it with its Monitor feature. Refer to the STM32 Motor Control Workbench user guide for more information on this feature.</p>
<h2>Motor Control Cockpit</h2>
<p >The <b>Motor Control Cockpit</b> integrates the software components into a motor control firmware subsystem and implements the regulation loops. It instantiates, configures and interfaces the firmware components selected in the PMSM FOC library and in the User Interface Library for the user’s application. The code of the Motor Control Cockpit is generated by STM32Cube as outlined above according to the characteristics of the application. Thanks to this generation the code of the cockpit only contains what is needed and is thus easily readable.</p>
<p ><a class="el" href="md_docs_motor_control_fw_architecture.html">Next: Motor Control Firmware architecture</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
