<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: Open Loop Control</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Open Loop Control<div class="ingroups"><a class="el" href="group___m_c_s_d_k.html">MCSDK</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Open Loop component of the Motor Control SDK.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:open__loop_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="open__loop_8h.html">open_loop.h</a></td></tr>
<tr class="memdesc:open__loop_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">This file contains all definitions and functions prototypes for the Open Loop component of the Motor Control SDK. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:open__loop_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="open__loop_8c.html">open_loop.c</a></td></tr>
<tr class="memdesc:open__loop_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This file provides firmware functions that implement the features of the Open Loop component. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="struct_open_loop___handle__t.html" title="OpenLoop_Handle_t structure used for phases definition.">OpenLoop_Handle_t</a> structure used for phases definition.  <a href="struct_open_loop___handle__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1154f9ccafe435dd045f111c32f1f7b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___open_loop.html#ga1154f9ccafe435dd045f111c32f1f7b5">OL_Init</a> (<a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *pHandle, <a class="el" href="struct_virtual_speed_sensor___handle__t.html">VirtualSpeedSensor_Handle_t</a> *pVSS)</td></tr>
<tr class="memdesc:ga1154f9ccafe435dd045f111c32f1f7b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes OpenLoop variables.it should be called once during Motor Control initialization.  <a href="group___open_loop.html#ga1154f9ccafe435dd045f111c32f1f7b5">More...</a><br /></td></tr>
<tr class="separator:ga1154f9ccafe435dd045f111c32f1f7b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5f0977754bedf849139295d2a2d3282"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structqd__t.html">qd_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___open_loop.html#gab5f0977754bedf849139295d2a2d3282">OL_VqdConditioning</a> (const <a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gab5f0977754bedf849139295d2a2d3282"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets Vqd according to open loop phase voltage. It should be called during current controller task.  <a href="group___open_loop.html#gab5f0977754bedf849139295d2a2d3282">More...</a><br /></td></tr>
<tr class="separator:gab5f0977754bedf849139295d2a2d3282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f4e8385d38a59f188864c7684191a01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___open_loop.html#ga3f4e8385d38a59f188864c7684191a01">OL_UpdateVoltage</a> (<a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *pHandle, int16_t hNewVoltage)</td></tr>
<tr class="memdesc:ga3f4e8385d38a59f188864c7684191a01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets new open loop phase voltage.  <a href="group___open_loop.html#ga3f4e8385d38a59f188864c7684191a01">More...</a><br /></td></tr>
<tr class="separator:ga3f4e8385d38a59f188864c7684191a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafec49e39c05fd33f298ca71a8e58b42b"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___open_loop.html#gafec49e39c05fd33f298ca71a8e58b42b">OL_GetVoltage</a> (<a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gafec49e39c05fd33f298ca71a8e58b42b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets open loop phase voltage.  <a href="group___open_loop.html#gafec49e39c05fd33f298ca71a8e58b42b">More...</a><br /></td></tr>
<tr class="separator:gafec49e39c05fd33f298ca71a8e58b42b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga380df512e7481caaf0653f39ef805e46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___open_loop.html#ga380df512e7481caaf0653f39ef805e46">OL_Calc</a> (<a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga380df512e7481caaf0653f39ef805e46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes phase voltage to apply according to average mechanical speed (V/F Mode). It should be called during background task.  <a href="group___open_loop.html#ga380df512e7481caaf0653f39ef805e46">More...</a><br /></td></tr>
<tr class="separator:ga380df512e7481caaf0653f39ef805e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55d4dea85d09f75255487b35ed274d4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___open_loop.html#ga55d4dea85d09f75255487b35ed274d4f">OL_VF</a> (<a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *pHandle, bool VFEnabling)</td></tr>
<tr class="memdesc:ga55d4dea85d09f75255487b35ed274d4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activates of the Voltage versus Frequency mode (V/F mode).  <a href="group___open_loop.html#ga55d4dea85d09f75255487b35ed274d4f">More...</a><br /></td></tr>
<tr class="separator:ga55d4dea85d09f75255487b35ed274d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Open Loop component of the Motor Control SDK. </p>
<p >Open Loop component allows to run the motor in open loop voltage mode. In that mode, the phase voltages are forced independently from the measured currents. To do so, the routine <a class="el" href="group___open_loop.html#gab5f0977754bedf849139295d2a2d3282" title="Sets Vqd according to open loop phase voltage. It should be called during current controller task.">OL_VqdConditioning()</a> overwrites the voltage command Vdq in the FOC current controller task. The voltage level to apply can be set directly by the user, with <a class="el" href="group___open_loop.html#ga3f4e8385d38a59f188864c7684191a01" title="Sets new open loop phase voltage.">OL_UpdateVoltage()</a>, or computed by <a class="el" href="group___open_loop.html#ga380df512e7481caaf0653f39ef805e46" title="Computes phase voltage to apply according to average mechanical speed (V/F Mode). It should be called...">OL_Calc()</a> if the V/F mode is selected. In that mode, the voltage level depends on the speed, the slope and the offset selected by the user. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga380df512e7481caaf0653f39ef805e46" name="ga380df512e7481caaf0653f39ef805e46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga380df512e7481caaf0653f39ef805e46">&#9670;&#160;</a></span>OL_Calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void OL_Calc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes phase voltage to apply according to average mechanical speed (V/F Mode). It should be called during background task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>Pointer on Handle structure of OpenLoop feature. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gafec49e39c05fd33f298ca71a8e58b42b" name="gafec49e39c05fd33f298ca71a8e58b42b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafec49e39c05fd33f298ca71a8e58b42b">&#9670;&#160;</a></span>OL_GetVoltage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak int16_t OL_GetVoltage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets open loop phase voltage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>Pointer on Handle structure of OpenLoop feature. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1154f9ccafe435dd045f111c32f1f7b5" name="ga1154f9ccafe435dd045f111c32f1f7b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1154f9ccafe435dd045f111c32f1f7b5">&#9670;&#160;</a></span>OL_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void OL_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_virtual_speed_sensor___handle__t.html">VirtualSpeedSensor_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pVSS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes OpenLoop variables.it should be called once during Motor Control initialization. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>Pointer on Handle structure of OpenLoop feature. </td></tr>
    <tr><td class="paramname">pVSS</td><td>Pointer on virtual speed sensor structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga3f4e8385d38a59f188864c7684191a01" name="ga3f4e8385d38a59f188864c7684191a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3f4e8385d38a59f188864c7684191a01">&#9670;&#160;</a></span>OL_UpdateVoltage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void OL_UpdateVoltage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>hNewVoltage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets new open loop phase voltage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>Pointer on Handle structure of OpenLoop feature. </td></tr>
    <tr><td class="paramname">hNewVoltage</td><td>New voltage value to apply. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga55d4dea85d09f75255487b35ed274d4f" name="ga55d4dea85d09f75255487b35ed274d4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga55d4dea85d09f75255487b35ed274d4f">&#9670;&#160;</a></span>OL_VF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void OL_VF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>VFEnabling</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activates of the Voltage versus Frequency mode (V/F mode). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>Pointer on Handle structure of OpenLoop feature. </td></tr>
    <tr><td class="paramname">VFEnabling</td><td>Flag to enable the V/F mode. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab5f0977754bedf849139295d2a2d3282" name="gab5f0977754bedf849139295d2a2d3282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab5f0977754bedf849139295d2a2d3282">&#9670;&#160;</a></span>OL_VqdConditioning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak <a class="el" href="structqd__t.html">qd_t</a> OL_VqdConditioning </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_open_loop___handle__t.html">OpenLoop_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets Vqd according to open loop phase voltage. It should be called during current controller task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>Pointer on Handle structure of OpenLoop feature. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="structqd__t.html" title="Two components q, d type definition.">qd_t</a></td><td>Vqd conditioned values. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
