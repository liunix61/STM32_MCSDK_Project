<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: State Observer CORDIC Speed &amp; Position Feedback</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">State Observer CORDIC Speed &amp; Position Feedback<div class="ingroups"><a class="el" href="group___m_c_s_d_k.html">MCSDK</a> &raquo; <a class="el" href="group___speedn_pos_fdbk.html">Speed &amp; Position Feedback</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>State Observer with CORDIC Speed &amp; Position Feedback implementation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:sto__cordic__speed__pos__fdbk_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sto__cordic__speed__pos__fdbk_8h.html">sto_cordic_speed_pos_fdbk.h</a></td></tr>
<tr class="memdesc:sto__cordic__speed__pos__fdbk_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">This file contains all definitions and functions prototypes for the State Observer + CORDIC Speed &amp; Position Feedback component of the Motor Control SDK. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used to handle an instance of the STO_CORDIC component.  <a href="struct_s_t_o___c_r___handle__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga743d2aec7b34a5f2a84a5de0ffd40b7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga743d2aec7b34a5f2a84a5de0ffd40b7f">STO_CR_Init</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga743d2aec7b34a5f2a84a5de0ffd40b7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">It initializes the state observer object.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga743d2aec7b34a5f2a84a5de0ffd40b7f">More...</a><br /></td></tr>
<tr class="separator:ga743d2aec7b34a5f2a84a5de0ffd40b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9354684fa1ad3dc9abf11d402588c5a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga9354684fa1ad3dc9abf11d402588c5a0">STO_CR_Clear</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga9354684fa1ad3dc9abf11d402588c5a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">It clears state observer object by re-initializing private variables.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga9354684fa1ad3dc9abf11d402588c5a0">More...</a><br /></td></tr>
<tr class="separator:ga9354684fa1ad3dc9abf11d402588c5a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6df4cf4bfdeee2235e4064aacee2b64"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gab6df4cf4bfdeee2235e4064aacee2b64">STO_CR_CalcElAngle</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle, <a class="el" href="struct_observer___inputs__t.html">Observer_Inputs_t</a> *pInputs)</td></tr>
<tr class="memdesc:gab6df4cf4bfdeee2235e4064aacee2b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method executes Luenberger state observer equations and calls CORDIC with the purpose of computing a new speed estimation and updating the estimated electrical angle.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gab6df4cf4bfdeee2235e4064aacee2b64">More...</a><br /></td></tr>
<tr class="separator:gab6df4cf4bfdeee2235e4064aacee2b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61ea59fb81d893742906d7203d642e34"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga61ea59fb81d893742906d7203d642e34">STO_CR_CalcAvrgMecSpeedUnit</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle, int16_t *pMecSpeedUnit)</td></tr>
<tr class="memdesc:ga61ea59fb81d893742906d7203d642e34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the rotor average mechanical speed in the unit defined by <a class="el" href="mc__stm__types_8h.html#a068140274b96a55eabb3ed3261c30d75" title="Rotation speed unit used at the interface with the application.">SPEED_UNIT</a> and writes it in pMecSpeedUnit.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga61ea59fb81d893742906d7203d642e34">More...</a><br /></td></tr>
<tr class="separator:ga61ea59fb81d893742906d7203d642e34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa9290ab193434b00d07f6272f078b2d6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gaa9290ab193434b00d07f6272f078b2d6">STO_CR_IsObserverConverged</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle, int16_t hForcedMecSpeedUnit)</td></tr>
<tr class="memdesc:gaa9290ab193434b00d07f6272f078b2d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the Observer has converged or false otherwise.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gaa9290ab193434b00d07f6272f078b2d6">More...</a><br /></td></tr>
<tr class="separator:gaa9290ab193434b00d07f6272f078b2d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef5f8b7d311e81f27248fb21ac9b7972"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structalphabeta__t.html">alphabeta_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gaef5f8b7d311e81f27248fb21ac9b7972">STO_CR_GetEstimatedBemf</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gaef5f8b7d311e81f27248fb21ac9b7972"><td class="mdescLeft">&#160;</td><td class="mdescRight">It exports estimated Bemf alpha-beta in <a class="el" href="structqd__t.html" title="Two components q, d type definition.">qd_t</a> format.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gaef5f8b7d311e81f27248fb21ac9b7972">More...</a><br /></td></tr>
<tr class="separator:gaef5f8b7d311e81f27248fb21ac9b7972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4cdeceaf9fd7a36501ad2db4e29ae37c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structalphabeta__t.html">alphabeta_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga4cdeceaf9fd7a36501ad2db4e29ae37c">STO_CR_GetEstimatedCurrent</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga4cdeceaf9fd7a36501ad2db4e29ae37c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It exports the stator current alpha-beta as estimated by state observer.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga4cdeceaf9fd7a36501ad2db4e29ae37c">More...</a><br /></td></tr>
<tr class="separator:ga4cdeceaf9fd7a36501ad2db4e29ae37c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4a4e43ac76880a09e4d07999b895c2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gae4a4e43ac76880a09e4d07999b895c2a">STO_CR_GetObserverGains</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle, int16_t *phC2, int16_t *phC4)</td></tr>
<tr class="memdesc:gae4a4e43ac76880a09e4d07999b895c2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">It exports current observer gains through parameters hhC2 and hhC4.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gae4a4e43ac76880a09e4d07999b895c2a">More...</a><br /></td></tr>
<tr class="separator:gae4a4e43ac76880a09e4d07999b895c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f0f9956789a29e2f6f234e8bc26e41c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga2f0f9956789a29e2f6f234e8bc26e41c">STO_CR_SetObserverGains</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle, int16_t hhC1, int16_t hhC2)</td></tr>
<tr class="memdesc:ga2f0f9956789a29e2f6f234e8bc26e41c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It allows setting new values for observer gains.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga2f0f9956789a29e2f6f234e8bc26e41c">More...</a><br /></td></tr>
<tr class="separator:ga2f0f9956789a29e2f6f234e8bc26e41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82534e1917822a2aa6e5d6f3fc78bf2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga82534e1917822a2aa6e5d6f3fc78bf2a">STO_CR_CalcAvrgElSpeedDpp</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga82534e1917822a2aa6e5d6f3fc78bf2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method must be called - at least - with the same periodicity on which speed control is executed. It computes and update object variable hElSpeedDpp that is estimated average electrical speed expressed in dpp used for instance in observer equations. Average is computed considering a FIFO depth equal to bSpeedBufferSizedpp.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga82534e1917822a2aa6e5d6f3fc78bf2a">More...</a><br /></td></tr>
<tr class="separator:ga82534e1917822a2aa6e5d6f3fc78bf2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5d0b83959c3d64c9faa0b811eb6fea3"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gae5d0b83959c3d64c9faa0b811eb6fea3">STO_CR_GetEstimatedBemfLevel</a> (const <a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gae5d0b83959c3d64c9faa0b811eb6fea3"><td class="mdescLeft">&#160;</td><td class="mdescRight">It exports estimated Bemf squared level.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gae5d0b83959c3d64c9faa0b811eb6fea3">More...</a><br /></td></tr>
<tr class="separator:gae5d0b83959c3d64c9faa0b811eb6fea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae618f76c6b84245c677bcf97cc8b2a18"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gae618f76c6b84245c677bcf97cc8b2a18">STO_CR_GetObservedBemfLevel</a> (const <a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gae618f76c6b84245c677bcf97cc8b2a18"><td class="mdescLeft">&#160;</td><td class="mdescRight">It exports observed Bemf squared level.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gae618f76c6b84245c677bcf97cc8b2a18">More...</a><br /></td></tr>
<tr class="separator:gae618f76c6b84245c677bcf97cc8b2a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga27f94f610b0d935119ea2a7dc595a6ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga27f94f610b0d935119ea2a7dc595a6ef">STO_CR_BemfConsistencyCheckSwitch</a> (<a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle, bool bSel)</td></tr>
<tr class="memdesc:ga27f94f610b0d935119ea2a7dc595a6ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">It enables/disables the bemf consistency check.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#ga27f94f610b0d935119ea2a7dc595a6ef">More...</a><br /></td></tr>
<tr class="separator:ga27f94f610b0d935119ea2a7dc595a6ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabcdaf3ef9603593858ed8f96e0213e3c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gabcdaf3ef9603593858ed8f96e0213e3c">STO_CR_IsBemfConsistent</a> (const <a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gabcdaf3ef9603593858ed8f96e0213e3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the result of the Bemf consistency check.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gabcdaf3ef9603593858ed8f96e0213e3c">More...</a><br /></td></tr>
<tr class="separator:gabcdaf3ef9603593858ed8f96e0213e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa1f1b1198e93c8cf05be29c860d704a8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gaa1f1b1198e93c8cf05be29c860d704a8">STO_CR_IsSpeedReliable</a> (const <a class="el" href="group___speedn_pos_fdbk.html#ga161a0878195349c8bcc94993b6dc1e51">STO_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gaa1f1b1198e93c8cf05be29c860d704a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method returns the reliability of the speed sensor.  <a href="group___s_t_o___c_o_r_d_i_c___speedn_pos_fdbk.html#gaa1f1b1198e93c8cf05be29c860d704a8">More...</a><br /></td></tr>
<tr class="separator:gaa1f1b1198e93c8cf05be29c860d704a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >State Observer with CORDIC Speed &amp; Position Feedback implementation. </p>
<p >This component uses a State Observer coupled with a CORDIC (COordinate Rotation DIgital Computer) to provide an estimation of the speed and the position of the rotor of the motor.</p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga27f94f610b0d935119ea2a7dc595a6ef" name="ga27f94f610b0d935119ea2a7dc595a6ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga27f94f610b0d935119ea2a7dc595a6ef">&#9670;&#160;</a></span>STO_CR_BemfConsistencyCheckSwitch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void STO_CR_BemfConsistencyCheckSwitch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bSel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It enables/disables the bemf consistency check. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
    <tr><td class="paramname">bSel</td><td>boolean; true enables check; false disables check </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga82534e1917822a2aa6e5d6f3fc78bf2a" name="ga82534e1917822a2aa6e5d6f3fc78bf2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga82534e1917822a2aa6e5d6f3fc78bf2a">&#9670;&#160;</a></span>STO_CR_CalcAvrgElSpeedDpp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void STO_CR_CalcAvrgElSpeedDpp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method must be called - at least - with the same periodicity on which speed control is executed. It computes and update object variable hElSpeedDpp that is estimated average electrical speed expressed in dpp used for instance in observer equations. Average is computed considering a FIFO depth equal to bSpeedBufferSizedpp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga61ea59fb81d893742906d7203d642e34" name="ga61ea59fb81d893742906d7203d642e34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61ea59fb81d893742906d7203d642e34">&#9670;&#160;</a></span>STO_CR_CalcAvrgMecSpeedUnit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool STO_CR_CalcAvrgMecSpeedUnit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>pMecSpeedUnit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the rotor average mechanical speed in the unit defined by <a class="el" href="mc__stm__types_8h.html#a068140274b96a55eabb3ed3261c30d75" title="Rotation speed unit used at the interface with the application.">SPEED_UNIT</a> and writes it in pMecSpeedUnit. </p>
<p >This method must be called - at least - with the same periodicity on which the speed control is executed. It computes and returns - through parameter pMecSpeedUnit - the rotor average mechanical speed, expressed in the unit defined by <a class="el" href="mc__stm__types_8h.html#a068140274b96a55eabb3ed3261c30d75" title="Rotation speed unit used at the interface with the application.">SPEED_UNIT</a>. Average is computed considering a FIFO depth equal to <a class="el" href="struct_s_t_o___c_r___handle__t.html#a6547ea19f6f28c1f9405e8daba5a996a">STO_CR_Handle_t::SpeedBufferSizeUnit</a>.</p>
<p >Moreover it also computes and returns the reliability state of the sensor, measured with reference to parameters <a class="el" href="struct_s_t_o___c_r___handle__t.html#a0a6fc7dbad952c13b36a7ff6c7dcde9e">STO_CR_Handle_t::Reliability_hysteresys</a>, <a class="el" href="struct_s_t_o___c_r___handle__t.html#a40dc5b30fb0837215dcc95447d33052d">STO_CR_Handle_t::VariancePercentage</a> and <a class="el" href="struct_s_t_o___c_r___handle__t.html#a6547ea19f6f28c1f9405e8daba5a996a">STO_CR_Handle_t::SpeedBufferSizeUnit</a> of the <a class="el" href="struct_s_t_o___c_r___handle__t.html" title="This structure is used to handle an instance of the STO_CORDIC component.">STO_CR_Handle_t</a> handle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
    <tr><td class="paramname">pMecSpeedUnit</td><td>pointer to int16_t, used to return the rotor average mechanical speed </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>if the sensor information is reliable, false otherwise </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab6df4cf4bfdeee2235e4064aacee2b64" name="gab6df4cf4bfdeee2235e4064aacee2b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab6df4cf4bfdeee2235e4064aacee2b64">&#9670;&#160;</a></span>STO_CR_CalcElAngle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak int16_t STO_CR_CalcElAngle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_observer___inputs__t.html">Observer_Inputs_t</a> *&#160;</td>
          <td class="paramname"><em>pInputs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method executes Luenberger state observer equations and calls CORDIC with the purpose of computing a new speed estimation and updating the estimated electrical angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component pInputs pointer to the observer inputs structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int16_t</td><td>rotor electrical angle (s16Degrees) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9354684fa1ad3dc9abf11d402588c5a0" name="ga9354684fa1ad3dc9abf11d402588c5a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9354684fa1ad3dc9abf11d402588c5a0">&#9670;&#160;</a></span>STO_CR_Clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void STO_CR_Clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It clears state observer object by re-initializing private variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>pointer on the component instance to work on. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaef5f8b7d311e81f27248fb21ac9b7972" name="gaef5f8b7d311e81f27248fb21ac9b7972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef5f8b7d311e81f27248fb21ac9b7972">&#9670;&#160;</a></span>STO_CR_GetEstimatedBemf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak <a class="el" href="structalphabeta__t.html">alphabeta_t</a> STO_CR_GetEstimatedBemf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It exports estimated Bemf alpha-beta in <a class="el" href="structqd__t.html" title="Two components q, d type definition.">qd_t</a> format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="structalphabeta__t.html" title="Two components alpha, beta type definition.">alphabeta_t</a></td><td>Bemf alpha-beta </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae5d0b83959c3d64c9faa0b811eb6fea3" name="gae5d0b83959c3d64c9faa0b811eb6fea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5d0b83959c3d64c9faa0b811eb6fea3">&#9670;&#160;</a></span>STO_CR_GetEstimatedBemfLevel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak int32_t STO_CR_GetEstimatedBemfLevel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It exports estimated Bemf squared level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int32_t</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4cdeceaf9fd7a36501ad2db4e29ae37c" name="ga4cdeceaf9fd7a36501ad2db4e29ae37c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4cdeceaf9fd7a36501ad2db4e29ae37c">&#9670;&#160;</a></span>STO_CR_GetEstimatedCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak <a class="el" href="structalphabeta__t.html">alphabeta_t</a> STO_CR_GetEstimatedCurrent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It exports the stator current alpha-beta as estimated by state observer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="structalphabeta__t.html" title="Two components alpha, beta type definition.">alphabeta_t</a></td><td>State observer estimated stator current Ialpha-beta </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae618f76c6b84245c677bcf97cc8b2a18" name="gae618f76c6b84245c677bcf97cc8b2a18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae618f76c6b84245c677bcf97cc8b2a18">&#9670;&#160;</a></span>STO_CR_GetObservedBemfLevel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak int32_t STO_CR_GetObservedBemfLevel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It exports observed Bemf squared level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int32_t</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae4a4e43ac76880a09e4d07999b895c2a" name="gae4a4e43ac76880a09e4d07999b895c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4a4e43ac76880a09e4d07999b895c2a">&#9670;&#160;</a></span>STO_CR_GetObserverGains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void STO_CR_GetObserverGains </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>phC2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>phC4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It exports current observer gains through parameters hhC2 and hhC4. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
    <tr><td class="paramname">phC2</td><td>pointer to int16_t used to return parameters hhC2 </td></tr>
    <tr><td class="paramname">phC4</td><td>pointer to int16_t used to return parameters hhC4 </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga743d2aec7b34a5f2a84a5de0ffd40b7f" name="ga743d2aec7b34a5f2a84a5de0ffd40b7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga743d2aec7b34a5f2a84a5de0ffd40b7f">&#9670;&#160;</a></span>STO_CR_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void STO_CR_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It initializes the state observer object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabcdaf3ef9603593858ed8f96e0213e3c" name="gabcdaf3ef9603593858ed8f96e0213e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabcdaf3ef9603593858ed8f96e0213e3c">&#9670;&#160;</a></span>STO_CR_IsBemfConsistent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool STO_CR_IsBemfConsistent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the result of the Bemf consistency check. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>Bemf consistency state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa9290ab193434b00d07f6272f078b2d6" name="gaa9290ab193434b00d07f6272f078b2d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa9290ab193434b00d07f6272f078b2d6">&#9670;&#160;</a></span>STO_CR_IsObserverConverged()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool STO_CR_IsObserverConverged </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>hForcedMecSpeedUnit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the Observer has converged or false otherwise. </p>
<p >Internally performs a set of checks necessary to state whether the state observer algorithm has converged or not.</p>
<p >This function is to be periodically called during the motor rev-up procedure at the same frequency as the *_CalcElAngle() functions.</p>
<p >It returns true if the estimated angle and speed can be considered reliable, false otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>pointer on the component instance </td></tr>
    <tr><td class="paramname">hForcedMecSpeedUnit</td><td>Mechanical speed as forced by VSS, in the unit defined by <a class="el" href="mc__stm__types_8h.html#a068140274b96a55eabb3ed3261c30d75" title="Rotation speed unit used at the interface with the application.">SPEED_UNIT</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa1f1b1198e93c8cf05be29c860d704a8" name="gaa1f1b1198e93c8cf05be29c860d704a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa1f1b1198e93c8cf05be29c860d704a8">&#9670;&#160;</a></span>STO_CR_IsSpeedReliable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool STO_CR_IsSpeedReliable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group___speedn_pos_fdbk.html#ga161a0878195349c8bcc94993b6dc1e51">STO_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This method returns the reliability of the speed sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>speed sensor reliability, measured with reference to parameters bReliability_hysteresys, hVariancePercentage and bSpeedBufferSize true = sensor information is reliable false = sensor information is not reliable </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2f0f9956789a29e2f6f234e8bc26e41c" name="ga2f0f9956789a29e2f6f234e8bc26e41c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f0f9956789a29e2f6f234e8bc26e41c">&#9670;&#160;</a></span>STO_CR_SetObserverGains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void STO_CR_SetObserverGains </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_t_o___c_r___handle__t.html">STO_CR_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>hhC1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>hhC2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It allows setting new values for observer gains. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the STO CORDIC component </td></tr>
    <tr><td class="paramname">wK1</td><td>new value for observer gain hhC1 </td></tr>
    <tr><td class="paramname">wK2</td><td>new value for observer gain hhC2 </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
