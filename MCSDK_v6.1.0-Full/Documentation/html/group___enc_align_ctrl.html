<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: Encoder Alignment Controller</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Encoder Alignment Controller<div class="ingroups"><a class="el" href="group___m_c_s_d_k.html">MCSDK</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Encoder Alignment Controller component of the Motor Control SDK.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:enc__align__ctrl_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="enc__align__ctrl_8h.html">enc_align_ctrl.h</a></td></tr>
<tr class="memdesc:enc__align__ctrl_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">This file contains all definitions and functions prototypes for the Encoder Alignment Control component of the Motor Control SDK. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:enc__align__ctrl_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="enc__align__ctrl_8c.html">enc_align_ctrl.c</a></td></tr>
<tr class="memdesc:enc__align__ctrl_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This file provides firmware functions that implement the features of the Encoder Alignment Control component of the Motor Control SDK. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This structure is used to handle an instance of EncAlignCtrl component.  <a href="struct_enc_align___handle__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4323a626f17c81bcafb9a3d15a8f2b4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___enc_align_ctrl.html#ga4323a626f17c81bcafb9a3d15a8f2b4f">EAC_Init</a> (<a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *pHandle, <a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *pSTC, <a class="el" href="struct_virtual_speed_sensor___handle__t.html">VirtualSpeedSensor_Handle_t</a> *pVSS, <a class="el" href="struct_e_n_c_o_d_e_r___handle__t.html">ENCODER_Handle_t</a> *pENC)</td></tr>
<tr class="memdesc:ga4323a626f17c81bcafb9a3d15a8f2b4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">It initializes the handle.  <a href="group___enc_align_ctrl.html#ga4323a626f17c81bcafb9a3d15a8f2b4f">More...</a><br /></td></tr>
<tr class="separator:ga4323a626f17c81bcafb9a3d15a8f2b4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1365f95fbdcc6bff57dc481be14f588"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___enc_align_ctrl.html#gad1365f95fbdcc6bff57dc481be14f588">EAC_StartAlignment</a> (<a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gad1365f95fbdcc6bff57dc481be14f588"><td class="mdescLeft">&#160;</td><td class="mdescRight">It starts the encoder alignment procedure. It configures the VSS (Virtual Speed Sensor) with the required angle and sets the STC (Speed and Torque Controller) to execute the required torque ramp.  <a href="group___enc_align_ctrl.html#gad1365f95fbdcc6bff57dc481be14f588">More...</a><br /></td></tr>
<tr class="separator:gad1365f95fbdcc6bff57dc481be14f588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf85d759718e8ef3f34a5ac9ee786c8cb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___enc_align_ctrl.html#gaf85d759718e8ef3f34a5ac9ee786c8cb">EAC_Exec</a> (<a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gaf85d759718e8ef3f34a5ac9ee786c8cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">It executes the encoder alignment controller and must be called with a frequency equal to the one settled in the parameters hEACFrequencyHz. Calling this method the EAC is able to verify if the alignment duration has been finished. At the end of alignment the encoder is set to the defined mechanical angle. Note: STC and VSS are not called by EAC_Exec.  <a href="group___enc_align_ctrl.html#gaf85d759718e8ef3f34a5ac9ee786c8cb">More...</a><br /></td></tr>
<tr class="separator:gaf85d759718e8ef3f34a5ac9ee786c8cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1143a87609066b685019db64ec1f9b04"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___enc_align_ctrl.html#ga1143a87609066b685019db64ec1f9b04">EAC_IsAligned</a> (<a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:ga1143a87609066b685019db64ec1f9b04"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns true if the encoder has been aligned at least one time, false if hasn't been never aligned.  <a href="group___enc_align_ctrl.html#ga1143a87609066b685019db64ec1f9b04">More...</a><br /></td></tr>
<tr class="separator:ga1143a87609066b685019db64ec1f9b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a2606f1df8523c1ffe6cd02419195cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___enc_align_ctrl.html#ga9a2606f1df8523c1ffe6cd02419195cc">EAC_SetRestartState</a> (<a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *pHandle, bool restart)</td></tr>
<tr class="memdesc:ga9a2606f1df8523c1ffe6cd02419195cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">It sets handler ENCrestart variable according to restart parameter.  <a href="group___enc_align_ctrl.html#ga9a2606f1df8523c1ffe6cd02419195cc">More...</a><br /></td></tr>
<tr class="separator:ga9a2606f1df8523c1ffe6cd02419195cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac50cda01e5c11ca9bcbfb7ed2111d9d2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___enc_align_ctrl.html#gac50cda01e5c11ca9bcbfb7ed2111d9d2">EAC_GetRestartState</a> (<a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *pHandle)</td></tr>
<tr class="memdesc:gac50cda01e5c11ca9bcbfb7ed2111d9d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if a restart after an encoder alignment has been requested.  <a href="group___enc_align_ctrl.html#gac50cda01e5c11ca9bcbfb7ed2111d9d2">More...</a><br /></td></tr>
<tr class="separator:gac50cda01e5c11ca9bcbfb7ed2111d9d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Encoder Alignment Controller component of the Motor Control SDK. </p>
<p >Initial encoder calibration which comprises a rotor alignment in a given position necessary to make the information coming from a quadrature encoder absolute. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaf85d759718e8ef3f34a5ac9ee786c8cb" name="gaf85d759718e8ef3f34a5ac9ee786c8cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf85d759718e8ef3f34a5ac9ee786c8cb">&#9670;&#160;</a></span>EAC_Exec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool EAC_Exec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It executes the encoder alignment controller and must be called with a frequency equal to the one settled in the parameters hEACFrequencyHz. Calling this method the EAC is able to verify if the alignment duration has been finished. At the end of alignment the encoder is set to the defined mechanical angle. Note: STC and VSS are not called by EAC_Exec. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the EncAlignCtrl component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>It returns true when the programmed alignment has been completed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac50cda01e5c11ca9bcbfb7ed2111d9d2" name="gac50cda01e5c11ca9bcbfb7ed2111d9d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac50cda01e5c11ca9bcbfb7ed2111d9d2">&#9670;&#160;</a></span>EAC_GetRestartState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool EAC_GetRestartState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if a restart after an encoder alignment has been requested. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the EncAlignCtrl component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>Encoder Alignment restart order flag </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4323a626f17c81bcafb9a3d15a8f2b4f" name="ga4323a626f17c81bcafb9a3d15a8f2b4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4323a626f17c81bcafb9a3d15a8f2b4f">&#9670;&#160;</a></span>EAC_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void EAC_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_speedn_torq_ctrl___handle__t.html">SpeednTorqCtrl_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pSTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_virtual_speed_sensor___handle__t.html">VirtualSpeedSensor_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pVSS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_o_d_e_r___handle__t.html">ENCODER_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pENC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It initializes the handle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the EncAlignCtrl component. </td></tr>
    <tr><td class="paramname">pSTC</td><td>Pointer to Speed and Torque Controller structure used by the EAC. </td></tr>
    <tr><td class="paramname">pVSS</td><td>Pointer to Virtual Speed Sensor structure used by the EAC. </td></tr>
    <tr><td class="paramname">pENC</td><td>Pointer to ENCoder structure used by the EAC. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1143a87609066b685019db64ec1f9b04" name="ga1143a87609066b685019db64ec1f9b04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1143a87609066b685019db64ec1f9b04">&#9670;&#160;</a></span>EAC_IsAligned()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak bool EAC_IsAligned </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns true if the encoder has been aligned at least one time, false if hasn't been never aligned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the EncAlignCtrl component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>Encoder Aligned flag </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9a2606f1df8523c1ffe6cd02419195cc" name="ga9a2606f1df8523c1ffe6cd02419195cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a2606f1df8523c1ffe6cd02419195cc">&#9670;&#160;</a></span>EAC_SetRestartState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void EAC_SetRestartState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>restart</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It sets handler ENCrestart variable according to restart parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the EncAlignCtrl component. </td></tr>
    <tr><td class="paramname">restart</td><td>Equal to true if a restart is programmed else false. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad1365f95fbdcc6bff57dc481be14f588" name="gad1365f95fbdcc6bff57dc481be14f588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad1365f95fbdcc6bff57dc481be14f588">&#9670;&#160;</a></span>EAC_StartAlignment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void EAC_StartAlignment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_enc_align___handle__t.html">EncAlign_Handle_t</a> *&#160;</td>
          <td class="paramname"><em>pHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It starts the encoder alignment procedure. It configures the VSS (Virtual Speed Sensor) with the required angle and sets the STC (Speed and Torque Controller) to execute the required torque ramp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pHandle</td><td>handler of the current instance of the EncAlignCtrl component. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
