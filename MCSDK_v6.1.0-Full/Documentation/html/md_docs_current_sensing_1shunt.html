<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 Motor Control SDK: Current sampling in single-shunt topology</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
});
</script>
<script type="text/javascript" async="async" src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="styleSheetFile.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="motor_control.png"/></td>
  <td id="projectalign">
   <div id="projectname">STM32 Motor Control SDK<span id="projectnumber">&#160;MCFW-6.1.0</span>
   </div>
   <div id="projectbrief">Software Development Kit to build applications driving PMSM Motors with STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Current sampling in single-shunt topology </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Overview</h1>
<p >The figure below illustrates the single-shunt topology hardware architecture:</p>
<div class="image">
<img src="current_sensing_1shunt_hwscheme.PNG" alt=""/>
<div class="caption">
Single-shunt hardware architecture</div></div>
    <p >It is possible to demonstrate that, for each configuration of the low-side switches, the current through the shunt resistor is given in the following table. \(T_4\), \(T_5\) and \(T_6\) assume the complementary values of \(T_1\), \(T_2\) and \(T_3\), respectively.</p>
<p >In the table below, value “$0$” means that the switch is open whereas value “$1$” means that the switch is closed.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">\(T_1\)   </th><th class="markdownTableHeadNone">\(T_2\)   </th><th class="markdownTableHeadNone">\(T_3\)   </th><th class="markdownTableHeadNone">\(I_{Shunt}\)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$0$    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$i_A$    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$-i_C$    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$i_B$    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$-i_A$    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$i_C$    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$0$   </td><td class="markdownTableBodyNone">$-i_B$    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$1$   </td><td class="markdownTableBodyNone">$0$   </td></tr>
</table>
<p >Using the centered-aligned pattern, each PWM period is subdivided into 7 subperiods as seen in the following figure. During three subperiods (I, IV, VII), the current through the shunt resistor is zero. During the other subperiods, the current through the shunt resistor is symmetrical with respect to the center of the PWM. From this, we can see two pairs:</p>
<ul>
<li>subperiods II and VI, during which \(i_{Shunt}\) is equal to \(–i_C\)</li>
<li>subperiods III and V, during which \(i_{Shunt}\) is equal to \(i_A\)</li>
</ul>
<p >Under these conditions, it is possible to reconstruct the three-phase current through the motor from the sampled values:</p>
<ul>
<li>\(i_A\) is iShunt measured during subperiod III or V</li>
<li>\(i_C\) is -iShunt measured during subperiod II or VI</li>
<li>\(i_B = –i_A – i_C\)</li>
</ul>
<div class="image">
<img src="single_shunt_current_reading.png" alt=""/>
<div class="caption">
Single-shunt current reading</div></div>
    <p >If the stator-voltage demand vector lies in the boundary space between two space vector sectors, two out of the three duty cycles will assume approximately the same value. In this case, the seven subperiods are reduced to five subperiods.</p>
<p >Under these conditions, only one current can be sampled, the other two cannot be reconstructed. This means that it is not possible to sense both currents during the same PWM period, when the imposed voltage demand vector falls in the gray area of the space vector diagram represented in the following figure:</p>
<div class="image">
<object type="image/svg+xml" data="boundaries_between_svpwm_sectors.svg" style="pointer-events: none;"></object>
<div class="caption">
Boundary between two space-vector sectors</div></div>
    <p >Similarly, for a low modulation index, the three duty cycles assume approximately the same value. In this case, the seven subperiods are reduced to three subperiods. During all three subperiods, the current through the shunt resistor is zero. This means that it is not possible to sense any current when the imposed voltage vector falls in the grey area of the space-vector diagram represented in the following figure:</p>
<div class="image">
<object type="image/svg+xml" data="low_mmi.svg" style="pointer-events: none;"></object>
<div class="caption">
Low modulation index</div></div>
    <h1>Definition of the noise parameter and boundary zone</h1>
<p >\(T_{Rise}\) is the time required for the data to become stable in the ADC channel after the power device has been switched on or off.</p>
<p >The duration of the ADC sampling is called the sampling time.</p>
<p >\(T_{MIN}\) is the minimum time required to perform the sampling, and</p>
<p >\(T_{MIN}\) = \(T_{Rise}\) + sampling time + dead time</p>
<p >\(D_{MIN}\) is the value of \(T_{MIN}\) expressed in duty cycle percent. It is related to the PWM frequency as follows:</p>
<p >$$ D_{MIN} = (T_{MIN} × F_{PWM}) × 100 $$</p>
<div class="image">
<object type="image/svg+xml" data="noise_parameters_definition.svg" style="pointer-events: none;"></object>
<div class="caption">
Definition of noise parameters</div></div>
    <h2>Regular region</h2>
<p >The voltage-demand vector lies in a region called the Regular region when the three duty cycles (calculated by space vector modulation) inside a PWM pattern differ from each other by more than \(D_{MIN}\). This is represented in the following figure:</p>
<div class="image">
<object type="image/svg+xml" data="1shunt_regular_region.svg" style="pointer-events: none;"></object>
<div class="caption">
Regular region</div></div>
    <h2><a class="anchor" id="boundary-1-region"></a>
Boundary 1 region</h2>
<p >The voltage-demand vector lies in a region called Boundary 1 when two duty cycles differ from each other by less than \(D_{MIN}\), and the third is greater than the other two and differs from them by more than \(D_{MIN}\). This is represented in this figure:</p>
<div class="image">
<object type="image/svg+xml" data="1shunt_boundary_1.svg" style="pointer-events: none;"></object>
<div class="caption">
Boundary 1</div></div>
    <h2><a class="anchor" id="boundary-2-region"></a>
Boundary 2 region</h2>
<p >The voltage-demand vector lies in a region called Boundary 2 when two duty cycles differ from each other by less than \(D_{MIN}\), and the third is smaller than the other two and differs from them by more than \(D_{MIN}\). This is represented in this figure:</p>
<div class="image">
<object type="image/svg+xml" data="1shunt_boundary_2.svg" style="pointer-events: none;"></object>
<div class="caption">
Boundary 2</div></div>
    <h2><a class="anchor" id="boundary-3-region"></a>
Boundary 3 region</h2>
<p >The voltage-demand vector lies in a region called Boundary 3 when the three PWM signals differ from each other by less than \(D_{MIN}\). This is represented in this figure:</p>
<div class="image">
<object type="image/svg+xml" data="1shunt_boundary_3.svg" style="pointer-events: none;"></object>
<div class="caption">
Boundary 3</div></div>
    <p ><a class="el" href="md_docs_single_shunt_phase_shift.html">Next: Single shunt with phase shift current sensing</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; 2022, ST Microelectronics &#160;<a href="http://st.com">
<img class="footer" src="ST_logo_footer.png" alt="ST Microelectronics"/>
</a>
</small></address>
</body>
</html>
